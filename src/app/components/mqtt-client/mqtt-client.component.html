<mat-card class="card">
  <mat-card-title>
    Mqtt Client
  </mat-card-title>
  <mat-card-content>
    <form [formGroup]="configurationForm">
      <mat-form-field class="form-field">
        <input matInput placeholder="Broker Address" [(ngModel)]="broker.brokerAddress" formControlName="mqttBrokerAddress"/>
        <mat-hint>Insert Broker Address</mat-hint> 
      </mat-form-field>
      <mat-form-field class="form-field">
        <input matInput placeholder="Broker Port" [(ngModel)]="broker.brokerPort" formControlName="mqttBrokerPort"/>
        <mat-hint>Insert Broker Port</mat-hint> 
      </mat-form-field>
      <mat-form-field class="form-field">
        <input matInput placeholder="Client ID" [(ngModel)]="broker.clientId" formControlName="mqttClientID"/>
        <mat-hint>Insert Client Id</mat-hint> 
      </mat-form-field>
      <mat-form-field class="form-field">
        <input matInput placeholder="Broker User" [(ngModel)]="broker.brokerUser" formControlName="mqttBrokerUser"/>
        <mat-hint>Insert Broker User</mat-hint> 
      </mat-form-field>
      <mat-form-field class="form-field">
        <input matInput placeholder="Broker Password" [(ngModel)]="broker.brokerPassword" formControlName="mqttBrokerPassword"/>
        <mat-hint>Insert Broker Password</mat-hint> 
      </mat-form-field>
      <mat-form-field class="form-field">
        <mat-select placeholder="Broker Protocol" [(ngModel)]="broker.protocol" formControlName="mqttBrokerProtocol">
          <mat-option *ngFor="let proto of protocol" value="{{proto}}">
            {{ proto }}
          </mat-option>
        </mat-select>
        <mat-hint>Insert Broker Protocol</mat-hint>
      </mat-form-field>
      <mat-form-field class="form-field">
        <mat-select placeholder="QoS" [(ngModel)]="broker.qos" formControlName="mqttQos">
          <mat-option value="0">
            0
          </mat-option>
          <mat-option value="1">
            1
          </mat-option>
          <mat-option value="2">
            2
          </mat-option>
        </mat-select>
        <mat-hint>Insert QoS type</mat-hint> 
      </mat-form-field>
    </form>
  </mat-card-content>
  <mat-card-actions>
   <span  class="buttons"> <button mat-raised-button color="primary" (click)="saveBrokerConfig()">Save</button></span>
   <span  class="buttons"> <button mat-raised-button color="primary" (click)="connectBroker()">Connect</button></span>
   <span  class="buttons"> <button mat-raised-button color="warn" (click)="disconnectBroker()">Disconnect</button></span>
   <span  class="buttons"> <button mat-raised-button color="warn" (click)="deleteBrokerConfig()">Delete</button></span>
  </mat-card-actions>
</mat-card>
<mat-card class="card">
  <mat-card-title>
    Topic
  </mat-card-title>
  <mat-card-content>
    <span>
      <form [formGroup]="topicForm">
        <mat-form-field class="form-field">
          <input matInput placeholder="Topic" [(ngModel)]="subscribeTo.topics[0]" formControlName="topicSubscribed"/>
          <mat-hint>Insert Topic to subscribe</mat-hint> 
        </mat-form-field>
      </form>
    </span> 
    <span>
      
    </span>
    <mat-card-actions>
     <span  class="buttons"> <button mat-raised-button color="primary" (click)="saveTopic()">Save</button></span>
     <span  class="buttons"> <button mat-raised-button color="primary" (click)="subscribeTopic()" (click)="drawer.open()">Subscribe</button></span>
     <span  class="buttons"> <button mat-raised-button color="primary" (click)="clearBuffer()">Clear</button></span>
     <span  class="buttons"> <button mat-raised-button color="warn" (click)="unsubscribeTopic()" (click)="drawer.close()">Unsubscribe</button></span>
     <span  class="buttons"> <button mat-raised-button color="warn" (click)="deleteTopic()">Delete</button></span>
      <mat-drawer-container class="example-container">
        <mat-drawer class="drawer" #drawer>
          <mat-list>
            <mat-list-item  *ngFor="let message of messages; let in = index">
             <span  class="buttons"> <button mat-button class="topic" (click)="openMessage(in)">{{ in }} :   {{ message.topic }} </button></span>
            </mat-list-item>
          </mat-list>
        </mat-drawer>
        <mat-drawer-content>
          
        </mat-drawer-content>
      </mat-drawer-container>

    </mat-card-actions>
  </mat-card-content>
  
</mat-card>

<mat-card class="card">
  <mat-card-title>
    {{ focussedMessage.topic ? focussedMessage.topic : 'Click on a topic to show the message here' }}
  </mat-card-title>
  <mat-card-content>
    <mat-card-subtitle class="subtitle">
      Protobuff info: 
    </mat-card-subtitle>

    <form [formGroup]="protoForm">
      <mat-form-field class="form-field">
        <input matInput placeholder="Proto Buff Path" [(ngModel)]="proto.protoBuffPath" formControlName="protoBuffPath"/>
        <mat-hint>Insert here the path where proto files are</mat-hint> 
      </mat-form-field>

      <mat-form-field class="form-field">
        <input matInput placeholder="Proto Buff File Name" [(ngModel)]="proto.protoBuffFile" formControlName="protoBuffFile"/>
        <mat-hint>Insert here the proto file name</mat-hint> 
      </mat-form-field>

      <mat-form-field class="form-field">
          <input matInput placeholder="Proto Buff Package" [(ngModel)]="proto.protoBuffPackage" formControlName="protoPackage"/>
          <mat-hint>Insert here the package</mat-hint> 
        </mat-form-field>
  
        <mat-form-field class="form-field">
          <input matInput placeholder="Proto Buff Message" [(ngModel)]="proto.protoBuffMessage" formControlName="protoMessage"/>
          <mat-hint>Insert here the proto message type</mat-hint> 
        </mat-form-field>
    </form>

    <mat-card-subtitle class="subtitle">
      Message:
    </mat-card-subtitle>
    <span class="messages">
      {{ focussedMessage.message }}
    </span>
  </mat-card-content>
  <mat-card-actions>
    <span class="buttons"> <button mat-raised-button color="primary" (click)="saveProto()">Save</button></span>
    <span class="buttons"> <button mat-raised-button color="primary" (click)="removeMessage()">Clear</button></span>
    <span class="buttons"> <button mat-raised-button color="warn" (click)="deleteProto()">Delete</button></span>
    <span class="buttons"> <button mat-raised-button color="accent" (click)="toHex()">Hex</button></span>
    <span class="buttons"> <button mat-raised-button color="accent" (click)="toStrings()">String</button></span>
    <span class="buttons"> <button mat-raised-button color="accent" (click)="toJson()">Json</button></span>
  </mat-card-actions>
</mat-card>